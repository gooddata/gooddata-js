---
layout: api
title: foobar
---
<div id="doc">
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <div id="api-tabview" class="tabview">
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul class="tabs">
                                <li><a href="#api-modules" class="category">Modules</a>
                                    <ul id="api-modules" class="apis modules">
                                        <li><a href="../modules/config.html">config</a></li>
                                        <li><a href="../modules/DataLayer.html">DataLayer</a></li>
                                        <li><a href="../modules/execution.html">execution</a></li>
                                        <li><a href="../modules/metadata.html">metadata</a></li>
                                        <li><a href="../modules/project.html">project</a></li>
                                        <li><a href="../modules/report.html">report</a></li>
                                        <li><a href="../modules/sdk.html">sdk</a></li>
                                        <li><a href="../modules/util.html">util</a></li>
                                        <li><a href="../modules/xhr.html">xhr</a></li>
                                    </ul>
                                </li>
                                <li><a href="#api-classes" class="category">Classes</a>
                                    <ul id="api-classes" class="apis classes">
                                        <li><a href="../classes/config.html">config</a></li>
                                        <li><a href="../classes/DataLayer.html">DataLayer</a></li>
                                        <li><a href="../classes/execution.html">execution</a></li>
                                        <li><a href="../classes/metadata.html">metadata</a></li>
                                        <li><a href="../classes/project.html">project</a></li>
                                        <li><a href="../classes/report.html">report</a></li>
                                        <li><a href="../classes/sdk.html">sdk</a></li>
                                        <li><a href="../classes/util.html">util</a></li>
                                        <li><a href="../classes/xhr.html">xhr</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <strong>gooddata-js</strong> <span class="version">v13.5.0</span>
                        <h1 class="file-heading">File: src/project.ts</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        // (C) 2007-2020 GoodData Corporation
                        import { getIn, handlePolling, getAllPagesByOffsetLimit } from &quot;./util&quot;;
                        import { ITimezone, IColor, IColorPalette, IFeatureFlags } from &quot;./interfaces&quot;;
                        import { IStyleSettingsResponse, IFeatureFlagsResponse } from &quot;./apiResponsesInterfaces&quot;;
                        import { XhrModule, ApiResponse } from &quot;./xhr&quot;;
                        
                        const DEFAULT_PALETTE = [
                            { r: 0x2b, g: 0x6b, b: 0xae },
                            { r: 0x69, g: 0xaa, b: 0x51 },
                            { r: 0xee, g: 0xb1, b: 0x4c },
                            { r: 0xd5, g: 0x3c, b: 0x38 },
                            { r: 0x89, g: 0x4d, b: 0x94 },
                            { r: 0x73, g: 0x73, b: 0x73 },
                            { r: 0x44, g: 0xa9, b: 0xbe },
                            { r: 0x96, g: 0xbd, b: 0x5f },
                            { r: 0xfd, g: 0x93, b: 0x69 },
                            { r: 0xe1, g: 0x5d, b: 0x86 },
                            { r: 0x7c, g: 0x6f, b: 0xad },
                            { r: 0xa5, g: 0xa5, b: 0xa5 },
                            { r: 0x7a, g: 0xa6, b: 0xd5 },
                            { r: 0x82, g: 0xd0, b: 0x8d },
                            { r: 0xff, g: 0xd2, b: 0x89 },
                            { r: 0xf1, g: 0x84, b: 0x80 },
                            { r: 0xbf, g: 0x90, b: 0xc6 },
                            { r: 0xbf, g: 0xbf, b: 0xbf },
                        ];
                        
                        const isProjectCreated = (project: any) =&gt; {
                            // TODO
                            const projectState = project.content.state;
                        
                            return projectState === &quot;ENABLED&quot; || projectState === &quot;DELETED&quot;;
                        };
                        
                        export interface IProjectConfigSettingItem {
                            settingItem: {
                                key: string;
                                links: {
                                    self: string;
                                };
                                source: string;
                                value: string;
                            };
                        }
                        export interface IProjectConfigResponse {
                            settings: {
                                items: IProjectConfigSettingItem[];
                            };
                        }
                        
                        // Parses string values to boolean, number and string
                        export const parseSettingItemValue = (value: string): boolean | number | string =&gt; {
                            if (value === &quot;true&quot;) {
                                return true;
                            }
                            if (value === &quot;false&quot;) {
                                return false;
                            }
                            const nr = Number(value);
                            if (nr.toString() === value) {
                                return nr;
                            }
                            return value;
                        };
                        
                        /**
                         * Functions for working with projects
                         *
                         * @class project
                         * @module project
                         */
                        export class ProjectModule {
                            constructor(private xhr: XhrModule) {}
                        
                            /**
                             * Get current project id
                             *
                             * @method getCurrentProjectId
                             * @return {String} current project identifier
                             */
                            public getCurrentProjectId() {
                                return this.xhr
                                    .get(&quot;/gdc/app/account/bootstrap&quot;)
                                    .then(r =&gt; r.getData())
                                    .then(this.getCurrentProjectIdInBootstrap);
                            }
                        
                            /**
                             * Return current project id in bootstrap
                             * @method getCurrentProjectIdInBootstrap
                             * @param bootstrapData - data was got from bootstrap resource
                             */
                            public getCurrentProjectIdInBootstrap(bootstrapData: any): string | null {
                                const currentProject = bootstrapData.bootstrapResource.current.project;
                                // handle situation in which current project is missing (e.g. new user)
                                if (!currentProject) {
                                    return null;
                                }
                        
                                return bootstrapData.bootstrapResource.current.project.links.self.split(&quot;/&quot;).pop();
                            }
                        
                            /**
                             * Fetches projects available for the user represented by the given profileId
                             *
                             * @method getProjects
                             * @param {String} profileId - User profile identifier
                             * @return {Array} An Array of projects
                             */
                            public getProjects(profileId: string) {
                                return getAllPagesByOffsetLimit(
                                    this.xhr,
                                    &#x60;/gdc/account/profile/${profileId}/projects&#x60;,
                                    &quot;projects&quot;,
                                ).then((result: any) =&gt; result.map((p: any) =&gt; p.project));
                            }
                        
                            /**
                             * Fetches all datasets for the given project
                             *
                             * @method getDatasets
                             * @param {String} projectId - GD project identifier
                             * @return {Array} An array of objects containing datasets metadata
                             */
                            public getDatasets(projectId: string) {
                                return this.xhr
                                    .get(&#x60;/gdc/md/${projectId}/query/datasets&#x60;)
                                    .then(r =&gt; r.getData())
                                    .then(getIn(&quot;query.entries&quot;));
                            }
                        
                            /**
                             * Fetches a chart color palette for a project represented by the given
                             * projectId parameter.
                             *
                             * @method getColorPalette
                             * @param {String} projectId - A project identifier
                             * @return {Array} An array of objects with r, g, b fields representing a project&#x27;s
                             * color palette
                             */
                            public getColorPalette(projectId: string) {
                                return this.xhr
                                    .get(&#x60;/gdc/projects/${projectId}/styleSettings&#x60;)
                                    .then(r =&gt; r.getData())
                                    .then(
                                        (result: any) =&gt; {
                                            return result.styleSettings.chartPalette.map((c: any) =&gt; {
                                                return {
                                                    r: c.fill.r,
                                                    g: c.fill.g,
                                                    b: c.fill.b,
                                                };
                                            });
                                        },
                                        err =&gt; {
                                            if (err.status === 200) {
                                                return DEFAULT_PALETTE;
                                            }
                        
                                            throw new Error(err.statusText);
                                        },
                                    );
                            }
                        
                            /**
                             * Fetches a chart color palette for a project represented by the given
                             * projectId parameter.
                             *
                             * @method getColorPaletteWithGuids
                             * @param {String} projectId - A project identifier
                             * @return {Array} An array of objects representing a project&#x27;s
                             * color palette with color guid or undefined
                             */
                            public getColorPaletteWithGuids(projectId: string): Promise&lt;IColorPalette | undefined&gt; {
                                return this.xhr
                                    .get(&#x60;/gdc/projects/${projectId}/styleSettings&#x60;)
                                    .then((apiResponse: ApiResponse) =&gt; {
                                        return apiResponse.getData();
                                    })
                                    .then((result: IStyleSettingsResponse) =&gt; {
                                        if (result &amp;&amp; result.styleSettings) {
                                            return result.styleSettings.chartPalette;
                                        } else {
                                            return undefined;
                                        }
                                    });
                            }
                        
                            /**
                             * Sets given colors as a color palette for a given project.
                             *
                             * @method setColorPalette
                             * @param {String} projectId - GD project identifier
                             * @param {Array} colors - An array of colors that we want to use within the project.
                             * Each color should be an object with r, g, b fields. // TODO really object?
                             */
                            public setColorPalette(projectId: string, colors: IColor[]): Promise&lt;ApiResponse&gt; {
                                return this.xhr.put(&#x60;/gdc/projects/${projectId}/styleSettings&#x60;, {
                                    body: {
                                        styleSettings: {
                                            chartPalette: colors.map((fill, idx: number) =&gt; {
                                                return { fill, guid: &#x60;guid${idx}&#x60; };
                                            }),
                                        },
                                    },
                                });
                            }
                        
                            /**
                             * Gets current timezone and its offset. Example output:
                             *
                             *     {
                             *         id: &#x27;Europe/Prague&#x27;,
                             *         displayName: &#x27;Central European Time&#x27;,
                             *         currentOffsetMs: 3600000
                             *     }
                             *
                             * @method getTimezone
                             * @param {String} projectId - GD project identifier
                             */
                            public getTimezone(projectId: string): Promise&lt;ITimezone&gt; {
                                const bootstrapUrl = &#x60;/gdc/app/account/bootstrap?projectId=${projectId}&#x60;;
                        
                                return this.xhr
                                    .get(bootstrapUrl)
                                    .then(r =&gt; r.getData())
                                    .then((result: any) =&gt; {
                                        return result.bootstrapResource.current.timezone;
                                    });
                            }
                        
                            public setTimezone(projectId: string, timezone: ITimezone) {
                                const timezoneServiceUrl = &#x60;/gdc/md/${projectId}/service/timezone&#x60;;
                                const data = {
                                    service: { timezone },
                                };
                        
                                return this.xhr
                                    .post(timezoneServiceUrl, {
                                        body: data,
                                    })
                                    .then(r =&gt; r.getData());
                            }
                        
                            /**
                             * Create project
                             * Note: returns a promise which is resolved when the project creation is finished
                             *
                             * @experimental
                             * @method createProject
                             * @param {String} title
                             * @param {String} authorizationToken
                             * @param {Object} options for project creation (summary, projectTemplate, ...)
                             * @return {Object} created project object
                             */
                            public createProject(title: string, authorizationToken: string, options: any = {}) {
                                const {
                                    summary,
                                    projectTemplate,
                                    driver = &quot;Pg&quot;,
                                    environment = &quot;TESTING&quot;,
                                    guidedNavigation = 1,
                                } = options;
                        
                                return this.xhr
                                    .post(&quot;/gdc/projects&quot;, {
                                        body: JSON.stringify({
                                            project: {
                                                content: {
                                                    guidedNavigation,
                                                    driver,
                                                    authorizationToken,
                                                    environment,
                                                },
                                                meta: {
                                                    title,
                                                    summary,
                                                    projectTemplate,
                                                },
                                            },
                                        }),
                                    })
                                    .then(r =&gt; r.getData())
                                    .then((project: any) =&gt;
                                        handlePolling(
                                            this.xhr.get.bind(this.xhr),
                                            project.uri,
                                            (response: any) =&gt; {
                                                // TODO project response
                                                return isProjectCreated(response.project);
                                            },
                                            options,
                                        ),
                                    );
                            }
                        
                            /**
                             * Delete project
                             *
                             * @method deleteProject
                             * @param {String} projectId
                             */
                            public deleteProject(projectId: string) {
                                return this.xhr.del(&#x60;/gdc/projects/${projectId}&#x60;);
                            }
                        
                            /**
                             * Gets aggregated feature flags for given project and current user
                             *
                             * @method getFeatureFlags
                             * @param {String} projectId - A project identifier
                             * @return {IFeatureFlags} Hash table of feature flags and theirs values where feature flag is as key
                             */
                            public getFeatureFlags(projectId: string): Promise&lt;IFeatureFlags&gt; {
                                return this.xhr
                                    .get(&#x60;/gdc/app/projects/${projectId}/featureFlags&#x60;)
                                    .then((apiResponse: ApiResponse) =&gt; {
                                        return apiResponse.getData();
                                    })
                                    .then((result: IFeatureFlagsResponse) =&gt; {
                                        if (result &amp;&amp; result.featureFlags) {
                                            return result.featureFlags;
                                        }
                                        return {};
                                    });
                            }
                        
                            /**
                             * Gets project config including project specific feature flags
                             *
                             * @param {String} projectId - A project identifier
                             * @return {IProjectConfigSettingItem[]} An array of project config setting items
                             */
                            public getConfig(projectId: string): Promise&lt;IProjectConfigSettingItem[]&gt; {
                                return this.xhr
                                    .get(&#x60;/gdc/app/projects/${projectId}/config&#x60;)
                                    .then((apiResponse: ApiResponse) =&gt; {
                                        const projectConfig = apiResponse.getData();
                                        return projectConfig;
                                    })
                                    .then((result: IProjectConfigResponse) =&gt; {
                                        if (result &amp;&amp; result.settings &amp;&amp; result.settings.items) {
                                            return result.settings.items;
                                        }
                                        return [];
                                    });
                            }
                        
                            /**
                             * Gets project specific feature flags
                             *
                             * @param {String} projectId - A project identifier
                             * @param {String} source - optional filter settingItems with specific source
                             * @return {IFeatureFlags} Hash table of feature flags and theirs values where feature flag is as key
                             */
                            public getProjectFeatureFlags(projectId: string, source?: string): Promise&lt;IFeatureFlags&gt; {
                                return this.getConfig(projectId).then((settingItems: IProjectConfigSettingItem[]) =&gt; {
                                    const filteredSettingItems = source
                                        ? settingItems.filter(settingItem =&gt; settingItem.settingItem.source === source)
                                        : settingItems;
                                    const featureFlags: IFeatureFlags = {};
                                    filteredSettingItems.forEach(settingItem =&gt; {
                                        featureFlags[settingItem.settingItem.key] = parseSettingItemValue(
                                            settingItem.settingItem.value,
                                        );
                                    });
                                    return featureFlags;
                                });
                            }
                        }
                        
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

