(function(e,t,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t[e]=r()})("sdk",this,function(){var e={reportDefinition:{content:{filters:[],format:"grid",grid:{rows:[],columns:[],sort:{columns:[],rows:[]},columnWidths:[],metrics:[]}},meta:{title:"Test",summary:"",tags:"",deprecated:0,category:"reportDefinition"}}},t=[{r:43,g:107,b:174},{r:105,g:170,b:81},{r:238,g:177,b:76},{r:213,g:60,b:56},{r:137,g:77,b:148},{r:115,g:115,b:115},{r:68,g:169,b:190},{r:150,g:189,b:95},{r:253,g:147,b:105},{r:225,g:93,b:134},{r:124,g:111,b:173},{r:165,g:165,b:165},{r:122,g:166,b:213},{r:130,g:208,b:141},{r:255,g:210,b:137},{r:241,g:132,b:128},{r:191,g:144,b:198},{r:191,g:191,b:191}],r=function(t){var r=t.filter(function(e){return"metric"===e.type}),n=t.filter(function(e){return"attribute"===e.type}),i=$.extend(!0,{},e),o=i.reportDefinition.content.grid;return o.metrics=r.map(function(e){return{uri:e.uri,alias:""}}),o.columns=n.map(function(e){return{attribute:{alias:"",totals:[[],[]],uri:e.uri}}}).concat(r.length?["metricGroup"]:[]),i},n=function(){return $.getJSON("/gdc/account/token")},i=function(e,t){var r=$.Deferred();return xhr.post("/gdc/account/login",{data:JSON.stringify({postUserLogin:{login:e,password:t,remember:1,captcha:"",verifyCaptcha:""}})}).then(r.resolve,r.reject),r.promise()},o=function(e){var t=$.Deferred();return xhr.get("/gdc/account/profile/"+e+"/projects").then(function(e){t.resolve(e.projects.map(function(e){return e.project}))},t.reject),t.promise()},a=function(e){var t=$.Deferred();return xhr.get("/gdc/md/"+e+"/query/datasets").then(function(e){t.resolve(e.query.entries)},t.reject),t.promise()},u=function(e){var r=$.Deferred();return xhr.get("/gdc/projects/"+e+"/styleSettings").then(function(e){r.resolve(e.styleSettings.chartPalette.map(function(e){return{r:e.fill.r,g:e.fill.g,b:e.fill.b}}))},function(e){200===e.status&&r.resolve(t),r.reject(e)}),r.promise()},c=function(e,t){var r=$.Deferred();return xhr.put("/gdc/projects/"+e+"/styleSettings",{data:{styleSettings:{chartPalette:t.map(function(e,t){return{guid:"guid"+t,fill:e}})}}}).then(r.resolve,r.reject),r.promise()},s=function(e,t){var r={execution:{columns:t}},n={isLoaded:!1},i=$.Deferred();return xhr.post("/gdc/internal/projects/"+e+"/experimental/executions",{data:JSON.stringify(r)},i.reject).then(function(e){return n.headers=e.executionResult.columns.map(function(e){return e.attributeDisplayForm?{type:"attrLabel",id:e.attributeDisplayForm.meta.identifier,uri:e.attributeDisplayForm.meta.uri,title:e.attributeDisplayForm.meta.title}:{type:"metric",id:e.metric.meta.identifier,title:e.metric.meta.title,format:e.metric.content.format}}),xhr.ajax(e.executionResult.tabularDataResult)},i.reject).then(function(e){n.rawData=e.tabularDataResult.values,n.isLoaded=!0,i.resolve(n)},i.reject),i.promise()},f=function(e){var t=$.Deferred();return xhr.get("/gdc/md/"+e+"/query/attributes").then(function(e){t.resolve(e.query.entries)},t.reject),t.promise()},l=function(e){var t=$.Deferred();return xhr.get("/gdc/md/"+e+"/query/dimensions").then(function(e){t.resolve(e.query.entries)},t.reject),t.promise()},d=function(e){var t=$.Deferred();return xhr.get("/gdc/md/"+e+"/query/metrics").then(function(e){t.resolve(e.query.entries)},t.reject),t.promise()},m=function(e,t){var r=$.Deferred();return xhr.post("/gdc/md/"+t+"/maqlvalidator").then(function(e){r.resolve(e)},r.reject),r.promise()},p=function(e){var t=Em.Object.create({isLoaded:!1,elementItems:void 0});return xhr.post(e.uri+"/validElements?order=asc",{data:JSON.stringify({validElementsRequest:{uris:[]}})}).then(function(e){t.setProperties({isLoaded:!0,elementItems:e.validElements.items})}),t},g=function(){var e=$.Deferred();return xhr.get("/gdc/app/account/bootstrap").then(function(t){var r=t.bootstrapResource.current.project.links.self;e.resolve(r.split("/").pop())},e.reject),e.promise()};return{DEFAULT_PALETTE:t,isLoggedIn:n,login:i,getProjects:o,getDatasets:a,getColorPalette:u,setColorPalette:c,getData:s,getAttributes:f,getDimensions:l,getMetrics:d,validateMaql:m,getValidElements:p,getReportDefinition:r,getCurrentProjectId:g}}),function(e,t,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t[e]=r()}("xhr",this,function(){var e,t,r={},n=function(e,t){r.ajax(e).done(function(e,r,n){t.resolve(e,r,n)}).fail(function(e,r,n){t.reject(e,r,n)})},i=function(t,r){e.done(function(){n(t,r)}).fail(function(e,t,n){401!==e.status&&r.reject(e,t,n)})},o=function(t,r){e||(e=$.ajax("/gdc/account/token/").always(function(){e=null}).fail(function(e,n,i){return 401===e.status&&$.isFunction(t.unauthorized)?(t.unauthorized(e),void 0):(r.reject(e,n,i),void 0)})),i(t,r)},a=function(e,t){setTimeout(function(){n(e,t)},e.pollDelay)},u=function(e,t,r){var n=e[t];delete e[t],$.isFunction(n)&&r(n),$.isArray(n)&&n.forEach(function(e){$.isFunction(n)&&r(e)})};r.ajaxSetup=function(e){t=$.extend({contentType:"application/json",dataType:"json",pollDelay:1e3},e)},r.ajax=function(r,n){$.isPlainObject(r)&&(n=r,r=void 0),n=$.extend({},t,n),r&&(n.url=r),$.isPlainObject(n.data)&&(n.data=JSON.stringify(n.data));var c=$.Deferred();return u(n,"success",c.done),u(n,"error",c.fail),u(n,"complete",c.always),e?(i(n,c),c):($.ajax(n).fail(function(e,t,r){401===e.status?o(n,c):c.reject(e,t,r)}).done(function(e,t,r){202===r.status?a(n,c):c.resolve(e,t,r)}),c)};var c=function c(e){return function(t,n){var i=$.extend(!0,{method:e},n);return r.ajax(t,i)}};return r.get=c("GET"),r.post=c("POST"),r.put=c("PUT"),r.ajaxSetup({}),r});